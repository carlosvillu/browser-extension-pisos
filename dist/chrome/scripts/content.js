!function(){"use strict";var e={16:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RentalDataAnalyzer=void 0,t.RentalDataAnalyzer=class{logger;propertyExtractor;cacheService;errorHandler;constructor(e,t,r,n){this.logger=e,this.propertyExtractor=t,this.cacheService=r,this.errorHandler=n}async fetchRentalData(e){const t=this.createCacheKey(e);return await this.cacheService.get(t)||this.fetchWithRetry(e,t,1)}async fetchWithRetry(e,t,r){const n={operation:"fetchRentalData",url:e};try{this.logger.log(`Fetching rental data (attempt ${r}): ${e}`);const n=await fetch(e,{method:"GET",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Language":"es-ES,es;q=0.5","User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36"}});if(!n.ok)throw new Error(`HTTP ${n.status}: Failed to fetch rental data`);const i=await n.text(),a=this.parseRentalDataFromHtml(i);return a&&await this.cacheService.set(t,a),a}catch(i){if(this.errorHandler.handleError(i,n),this.errorHandler.shouldRetry(i,r)){const n=this.errorHandler.getRetryDelay(r);return this.logger.log(`Retrying in ${n}ms (attempt ${r+1})`),await this.delay(n),this.fetchWithRetry(e,t,r+1)}return null}}createCacheKey(e){try{const t=new URL(e);return`${t.pathname}${t.search}`}catch{return e}}delay(e){return new Promise((t=>setTimeout(t,e)))}parseRentalDataFromHtml(e){try{const t=(new DOMParser).parseFromString(e,"text/html"),r=this.propertyExtractor.extractPropertiesFromDocument(t);if(0===r.length)return this.logger.log("No rental properties found in response"),null;const n=r.map((e=>e.price)).filter((e=>e>0)).sort(((e,t)=>e-t));if(0===n.length)return this.logger.log("No valid prices found in rental properties"),null;const i=n.reduce(((e,t)=>e+t),0)/n.length,a=n[0],o=n[n.length-1];return this.logger.log(`Rental analysis: ${n.length} properties, avg: ${i}‚Ç¨`),{averagePrice:Math.round(i),minPrice:a,maxPrice:o,sampleSize:n.length,properties:r}}catch(e){return this.logger.error("Error parsing rental data from HTML",e),null}}}},47:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IntersectionSimpleLazyLoader=void 0,t.IntersectionSimpleLazyLoader=class{logger;observer=null;processedElements=new Set;constructor(e){this.logger=e}observeElements(e,t){this.observer||(this.observer=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&!this.processedElements.has(e.target)&&(this.processedElements.add(e.target),t(e.target),this.observer.unobserve(e.target))}))}),{rootMargin:"100px",threshold:.1})),e.forEach((e=>{this.processedElements.has(e)||this.observer.observe(e)}))}disconnect(){this.observer&&(this.observer.disconnect(),this.processedElements.clear(),this.observer=null)}}},75:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RobustErrorHandler=void 0,t.RobustErrorHandler=class{logger;maxRetries=3;baseDelay=1e3;errorCounts=new Map;constructor(e){this.logger=e}handleError(e,t){const r=`${t.operation}-${e.name}`,n=this.errorCounts.get(r)||0;this.errorCounts.set(r,n+1),this.logger.error(`Error in ${t.operation}`,{error:e.message,stack:e.stack,context:t,errorCount:n+1}),e.message.includes("fetch")?this.logger.error("Network error detected",{url:t.url,propertyId:t.propertyId}):(e.message.includes("parse")||e.message.includes("DOM"))&&this.logger.error("Parsing error detected",{operation:t.operation,additionalData:t.additionalData})}shouldRetry(e,t){return!(t>=this.maxRetries||!(e.message.includes("fetch")||e.message.includes("network")||e.message.includes("timeout"))&&!(e.message.includes("500")||e.message.includes("502")||e.message.includes("503")||e.message.includes("504")))}getRetryDelay(e){const t=this.baseDelay*Math.pow(2,e);return t+.1*Math.random()*t}getErrorStats(){return Object.fromEntries(this.errorCounts)}clearErrorStats(){this.errorCounts.clear(),this.logger.log("Error statistics cleared")}}},169:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ProfitabilityCalculator=void 0;const n=r(294);t.ProfitabilityCalculator=class{logger;config;DEFAULT_CONFIG={propertyManagementRate:.09,insuranceRate:.002,propertyTaxRate:.007,communityFeesWithGarage:80,communityFeesWithoutGarage:40,vacancyMaintenanceRate:.05};configService;userConfig;constructor(e,t={}){this.logger=e,this.config=t,this.config={...this.DEFAULT_CONFIG,...t},this.configService=new n.ConfigService}async calculateProfitability(e,t){this.userConfig||(this.userConfig=await this.configService.getConfig());const r=this.userConfig.expenseConfig,n=t.averagePrice,i=12*n,a=e.price,o=i/a*100,s=this.calculateMonthlyExpenses(e,n,r),l=i-12*s,c=Math.max(0,l/a*100),{recommendation:d,riskLevel:g}=this.evaluateInvestment(o,c,t.sampleSize);return this.logger.log(`Profitability calculation for ${e.id}: Gross ${o.toFixed(2)}%, Net ${c.toFixed(2)}%`),{propertyId:e.id,purchasePrice:a,estimatedRent:n,grossYield:Math.round(100*o)/100,netYield:Math.round(100*c)/100,monthlyExpenses:s,recommendation:d,riskLevel:g}}calculateMonthlyExpenses(e,t,r){let n=0;return n+=r.propertyManagementMonthly||150,n+=r.insuranceMonthly||50,n+=r.propertyTaxMonthly||100,n+=r.communityFees||60,n+=t*(r.vacancyMaintenanceRate||.05),n+=t*(r.maintenanceContingencyRate||.01),Math.round(n)}evaluateInvestment(e,t,r){let n,i;const a=this.userConfig?.profitabilityThresholds||{excellent:6,good:4,fair:2};return n=t>=a.excellent?"excellent":t>=a.good?"good":t>=a.fair?"fair":"poor",i=r<3||e>8||t<1?"high":t>=3&&e<=7?"low":"medium",{recommendation:n,riskLevel:i}}}},273:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IdealistaInvestmentAnalyzer=void 0;const n=r(530),i=r(516),a=r(922),o=r(16),s=r(169),l=r(841),c=r(677),d=r(420),g=r(75),m=r(47);t.IdealistaInvestmentAnalyzer=class{logger;urlAnalyzer;propertyExtractor;rentalDataAnalyzer;profitabilityCalculator;urlGenerator;uiRenderer;cacheService;errorHandler;lazyLoader;constructor(){this.logger=new n.Logger("IdealistaInvestmentAnalyzer"),this.urlAnalyzer=new i.UrlAnalyzer(this.logger),this.propertyExtractor=new a.PropertyExtractor(this.logger),this.cacheService=new d.ContentCacheService(this.logger),this.errorHandler=new g.RobustErrorHandler(this.logger),this.rentalDataAnalyzer=new o.RentalDataAnalyzer(this.logger,this.propertyExtractor,this.cacheService,this.errorHandler),this.profitabilityCalculator=new s.ProfitabilityCalculator(this.logger),this.urlGenerator=new l.CrossReferenceUrlGenerator(this.logger),this.uiRenderer=new c.InvestmentUIRenderer(this.logger),this.lazyLoader=new m.IntersectionSimpleLazyLoader(this.logger)}initialize(){this.logger.log("Initializing Idealista Investment Analyzer"),this.urlAnalyzer.isIdealistaPropertyPage()?(this.logger.log("Idealista property page detected"),this.analyzeCurrentPage()):this.logger.log("Not an Idealista property page")}analyzeCurrentPage(){const e=this.urlAnalyzer.analyzeCurrentPage();e.searchType&&this.startPropertyAnalysis(e)}startPropertyAnalysis(e){this.logger.log(`Starting analysis for ${e.searchType} properties in ${e.location}`);const t=this.propertyExtractor.extractPropertiesFromPage();this.logger.log(`Found ${t.length} properties on page`),t.length>0&&this.processProperties(t,e)}processProperties(e,t){if(this.logger.log("Processing properties for investment analysis"),"venta"!==t.searchType)return void this.logger.log("Skipping analysis - not a sale search");const r=e.map((e=>({property:e,element:document.querySelector(`article.item[data-element-id="${e.id}"]`)}))).filter((e=>null!==e.element));if(0===r.length)return this.logger.log("No property elements found, processing directly with delays"),void this.processBatch(e,t);const n=r.map((e=>e.element));this.lazyLoader.observeElements(n,(e=>{const n=r.find((t=>t.element===e))?.property;n&&this.analyzePropertyProfitability(n,t)}))}async processBatch(e,t){this.logger.log("Processing properties in batch mode with delays");for(const r of e)await this.analyzePropertyProfitability(r,t),await this.delay(2e3)}delay(e){return new Promise((t=>setTimeout(t,e)))}async analyzePropertyProfitability(e,t){this.logger.log(`Analyzing property ${e.id}: ${e.price}‚Ç¨ - ${e.rooms} hab., ${e.size}m¬≤`);const r={operation:"analyzePropertyProfitability",propertyId:e.id,additionalData:{price:e.price,rooms:e.rooms,size:e.size}};try{await this.uiRenderer.renderLoadingBadge(e);const r=this.urlGenerator.generateRentalUrl(t.location,e);this.logger.log(`Fetching rental data from: ${r}`);const n=await this.rentalDataAnalyzer.fetchRentalData(r);if(n&&n.sampleSize>0){const t=await this.profitabilityCalculator.calculateProfitability(e,n);this.logger.log(`Profitability analysis for ${e.id}:`,t),await this.uiRenderer.renderBadge(e,t)}else this.logger.log(`No rental data found for property ${e.id}`),this.handleMissingData(e)}catch(t){this.errorHandler.handleError(t,r),this.handleAnalysisError(e)}}handleMissingData(e){this.uiRenderer.renderNoDataBadge(e)}handleAnalysisError(e){this.uiRenderer.removeBadge(e)}}},294:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigService=void 0;class r{static STORAGE_KEY="investmentAnalysisConfig";static DEFAULT_CONFIG={expenseConfig:{propertyManagementMonthly:150,insuranceMonthly:50,propertyTaxMonthly:100,communityFees:60,vacancyMaintenanceRate:.05,maintenanceContingencyRate:.01},mortgageConfig:{loanToValueRatio:.8,managementFeesRate:.1,interestRate:2.45},profitabilityThresholds:{excellent:6,good:4,fair:2},displayOptions:{showBadges:!0,showModal:!0,showLoadingStates:!0}};async getConfig(){try{const e=(await chrome.storage.sync.get(r.STORAGE_KEY))[r.STORAGE_KEY];if(!e)return r.DEFAULT_CONFIG;const t=this.migrateOldConfig(e);return{...r.DEFAULT_CONFIG,...t}}catch(e){return console.error("Error loading config:",e),r.DEFAULT_CONFIG}}migrateOldConfig(e){if(e.expenseConfig&&e.expenseConfig.communityFeesWithGarage&&!e.expenseConfig.communityFees){const t=Math.round(((e.expenseConfig.communityFeesWithGarage||80)+(e.expenseConfig.communityFeesWithoutGarage||40))/2);e.expenseConfig.communityFees=t,delete e.expenseConfig.communityFeesWithGarage,delete e.expenseConfig.communityFeesWithoutGarage}return e}async updateConfig(e){try{const t={...await this.getConfig(),...e};await chrome.storage.sync.set({[r.STORAGE_KEY]:t})}catch(e){throw console.error("Error saving config:",e),e}}async resetToDefaults(){try{await chrome.storage.sync.set({[r.STORAGE_KEY]:r.DEFAULT_CONFIG})}catch(e){throw console.error("Error resetting config:",e),e}}}t.ConfigService=r},420:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ContentCacheService=void 0,t.ContentCacheService=class{logger;constructor(e){this.logger=e}async get(e){try{const t=await chrome.runtime.sendMessage({type:"CACHE_GET",key:e});if(!t.success)throw new Error(t.error);return t.data}catch(t){return this.logger.error(`Error getting cache for key ${e}:`,t),null}}async set(e,t,r){try{const n=await chrome.runtime.sendMessage({type:"CACHE_SET",key:e,data:t,ttl:r});if(!n.success)throw new Error(n.error)}catch(t){this.logger.error(`Error setting cache for key ${e}:`,t)}}async clear(){try{const e=await chrome.runtime.sendMessage({type:"CACHE_CLEAR"});if(!e.success)throw new Error(e.error)}catch(e){this.logger.error("Error clearing cache:",e)}}async cleanup(){try{const e=await chrome.runtime.sendMessage({type:"CACHE_CLEANUP"});if(!e.success)throw new Error(e.error)}catch(e){this.logger.error("Error during cache cleanup:",e)}}}},516:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UrlAnalyzer=void 0,t.UrlAnalyzer=class{logger;constructor(e){this.logger=e}analyzeCurrentPage(){const e=new URL(window.location.href);return this.analyzeUrl(e)}analyzeUrl(e){const t=e.pathname,r=e.searchParams;let n=null;t.includes("/venta-viviendas/")?n="venta":t.includes("/alquiler-viviendas/")&&(n="alquiler");const i=this.extractLocationFromUrl(t),a=r.toString().length>0,o={isIdealista:"www.idealista.com"===e.hostname&&(t.includes("/venta-viviendas/")||t.includes("/alquiler-viviendas/")),searchType:n,location:i,hasFilters:a};return this.logger.log("URL Analysis:",o),o}isIdealistaPropertyPage(){const e=window.location.hostname,t=window.location.pathname;return"www.idealista.com"===e&&(t.includes("/venta-viviendas/")||t.includes("/alquiler-viviendas/"))}extractLocationFromUrl(e){const t=e.match(/\/(venta|alquiler)-viviendas\/([^/]+)/);return t?t[2]:null}}},530:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0,t.Logger=class{context;constructor(e){this.context=e}log(e,t){const r=`[${(new Date).toISOString()}][${this.context}]`;t?console.log(`${r} ${e}`,t):console.log(`${r} ${e}`)}error(e,t){const r=`[${(new Date).toISOString()}][${this.context}][ERROR]`;t?console.error(`${r} ${e}`,t):console.error(`${r} ${e}`)}}},677:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.InvestmentUIRenderer=void 0;const n=r(294);t.InvestmentUIRenderer=class{logger;configService;userConfig;constructor(e){this.logger=e,this.configService=new n.ConfigService}async renderBadge(e,t){if(this.userConfig||(this.userConfig=await this.configService.getConfig()),!this.userConfig.displayOptions.showBadges)return;const r=this.findPropertyElement(e.id);if(!r)return void this.logger.error(`Property element not found for ID: ${e.id}`);this.removeBadge(e);const n=this.createAnalysisButton(e,t),i=r.querySelector(".item-description");i?(i.parentNode?.insertBefore(n,i.nextSibling),this.logger.log(`Investment analysis button rendered for property ${e.id}: ${t.recommendation}`)):this.logger.error(`Description container not found for property ${e.id}`)}async renderLoadingBadge(e){if(this.userConfig||(this.userConfig=await this.configService.getConfig()),!this.userConfig.displayOptions.showLoadingStates)return;const t=this.findPropertyElement(e.id);if(!t)return;this.removeBadge(e);const r=document.createElement("div");r.className="investment-badge investment-badge--loading",r.setAttribute("data-property-id",e.id),r.textContent="Analyzing...";const n=t.querySelector(".item-multimedia");n&&(n.appendChild(r),this.logger.log(`Loading badge rendered for property ${e.id}`))}renderNoDataBadge(e){const t=this.findPropertyElement(e.id);if(!t)return;this.removeBadge(e);const r=document.createElement("div");r.className="investment-badge investment-badge--no-data",r.setAttribute("data-property-id",e.id),r.innerHTML='\n      <div class="investment-badge__content">\n        <div class="investment-badge__icon">üìä</div>\n        <div class="investment-badge__text">Sin datos de alquiler</div>\n      </div>\n    ';const n=t.querySelector(".item-multimedia");n&&(n.appendChild(r),this.logger.log(`No data badge rendered for property ${e.id}`))}renderErrorBadge(e){const t=this.findPropertyElement(e.id);if(!t)return;this.removeBadge(e);const r=document.createElement("div");r.className="investment-badge investment-badge--error",r.setAttribute("data-property-id",e.id),r.innerHTML='\n      <div class="investment-badge__content">\n        <div class="investment-badge__icon">‚ö†Ô∏è</div>\n        <div class="investment-badge__text">Error en an√°lisis</div>\n      </div>\n    ';const n=t.querySelector(".item-multimedia");n&&(n.appendChild(r),this.logger.log(`Error badge rendered for property ${e.id}`))}removeBadge(e){document.querySelectorAll(`[data-property-id="${e.id}"]`).forEach((e=>e.remove()))}findPropertyElement(e){return document.querySelector(`article.item[data-element-id="${e}"]`)}createAnalysisButton(e,t){const r=document.createElement("div");r.className="investment-analysis-container",r.setAttribute("data-property-id",t.propertyId);const n=document.createElement("button");return n.className=`investment-analysis-button investment-analysis-button--${t.recommendation}`,n.innerHTML=`\n      <div class="investment-analysis-button__content">\n        <div class="investment-analysis-button__yield">\n          <span class="investment-analysis-button__yield-label">Rentabilidad Neta:</span>\n          <span class="investment-analysis-button__yield-value">${t.netYield}%</span>\n        </div>\n        <div class="investment-analysis-button__recommendation">\n          ${this.getRecommendationText(t.recommendation)}\n        </div>\n        <div class="investment-analysis-button__icon">üìä</div>\n      </div>\n    `,n.addEventListener("click",(async r=>{r.preventDefault(),r.stopPropagation(),this.userConfig||(this.userConfig=await this.configService.getConfig()),this.userConfig.displayOptions.showModal&&(this.openAnalysisModal(e,t),this.logger.log(`Investment modal opened for property ${e.id}`))})),r.appendChild(n),r}openAnalysisModal(e,t){new i(this.logger).openModal(e,t)}getRecommendationText(e){switch(e){case"excellent":return"EXCELENTE INVERSI√ìN";case"good":return"BUENA INVERSI√ìN";case"fair":return"INVERSI√ìN REGULAR";case"poor":return"MALA INVERSI√ìN";default:return"DESCONOCIDO"}}};class i{logger;constructor(e){this.logger=e}openModal(e,t){const r=document.querySelector(".investment-modal-overlay");r&&r.remove();const n=document.createElement("div");n.className="investment-modal-overlay";const i=document.createElement("div");i.className="investment-modal",i.innerHTML=this.createModalContent(e,t),n.appendChild(i),document.body.appendChild(n),this.addEventListeners(i,n)}createModalContent(e,t){return`\n      <div class="investment-modal__header">\n        <h3 class="investment-modal__title">An√°lisis de Inversi√≥n</h3>\n        <button class="investment-modal__close">√ó</button>\n      </div>\n      \n      <div class="investment-modal__content">\n        <div class="investment-modal__property-info">\n          <h4>${e.title}</h4>\n          <p class="investment-modal__property-details">\n            ${e.rooms?e.rooms+" hab.":""} \n            ${e.size?e.size+"m¬≤":""}\n            ${e.floor?" ‚Ä¢ "+e.floor:""}\n          </p>\n        </div>\n\n        <div class="investment-modal__analysis">\n          <div class="investment-modal__recommendation investment-modal__recommendation--${t.recommendation}">\n            <div class="investment-modal__recommendation-text">\n              ${this.getRecommendationText(t.recommendation)}\n            </div>\n            <div class="investment-modal__recommendation-yield">\n              Rentabilidad Neta: ${t.netYield}%\n            </div>\n          </div>\n\n          <div class="investment-modal__details-grid">\n            <div class="investment-modal__detail-item">\n              <span class="investment-modal__label">Precio de compra</span>\n              <span class="investment-modal__value">${t.purchasePrice.toLocaleString()}‚Ç¨</span>\n            </div>\n            \n            <div class="investment-modal__detail-item">\n              <span class="investment-modal__label">Alquiler estimado mensual</span>\n              <span class="investment-modal__value">${t.estimatedRent.toLocaleString()}‚Ç¨</span>\n            </div>\n            \n            <div class="investment-modal__detail-item">\n              <span class="investment-modal__label">Gastos mensuales estimados</span>\n              <span class="investment-modal__value">${t.monthlyExpenses.toLocaleString()}‚Ç¨</span>\n            </div>\n            \n            <div class="investment-modal__divider"></div>\n            \n            <div class="investment-modal__detail-item">\n              <span class="investment-modal__label">Rentabilidad bruta anual</span>\n              <span class="investment-modal__value">${t.grossYield}%</span>\n            </div>\n            \n            <div class="investment-modal__detail-item investment-modal__detail-item--highlight">\n              <span class="investment-modal__label">Rentabilidad neta anual</span>\n              <span class="investment-modal__value">${t.netYield}%</span>\n            </div>\n            \n            <div class="investment-modal__risk investment-modal__risk--${t.riskLevel}">\n              <div class="investment-modal__risk-dot"></div>\n              <span>Nivel de riesgo: ${t.riskLevel.toUpperCase()}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    `}addEventListeners(e,t){const r=e.querySelector(".investment-modal__close");r?.addEventListener("click",(()=>{t.remove()})),t.addEventListener("click",(e=>{e.target===t&&t.remove()}));const n=e=>{"Escape"===e.key&&(t.remove(),document.removeEventListener("keydown",n))};document.addEventListener("keydown",n)}getRecommendationText(e){switch(e){case"excellent":return"EXCELENTE INVERSI√ìN";case"good":return"BUENA INVERSI√ìN";case"fair":return"INVERSI√ìN REGULAR";case"poor":return"MALA INVERSI√ìN";default:return"DESCONOCIDO"}}}},841:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CrossReferenceUrlGenerator=void 0,t.CrossReferenceUrlGenerator=class{logger;constructor(e){this.logger=e}generateRentalUrl(e,t){return this.buildUrl("https://www.idealista.com/alquiler-viviendas",e,t)}generateSaleUrl(e,t){return this.buildUrl("https://www.idealista.com/venta-viviendas",e,t)}buildUrl(e,t,r){if(!t)return this.logger.error("No location provided for URL generation"),`${e}/`;let n=`${e}/${t}/`;const i=new URLSearchParams;if(r.rooms&&r.rooms>0&&i.append("habitaciones",r.rooms.toString()),r.size&&r.size>0){const e=Math.max(1,r.size-20),t=r.size+20;i.append("superficie",`${e}-${t}`)}const a=i.toString();return a&&(n+=`?${a}`),n}}},922:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PropertyExtractor=void 0,t.PropertyExtractor=class{logger;constructor(e){this.logger=e}extractPropertiesFromPage(){const e=[],t=document.querySelectorAll("article.item[data-element-id]");return this.logger.log(`Found ${t.length} property elements on page`),t.forEach((t=>{try{const r=this.extractPropertyData(t);r&&e.push(r)}catch(e){this.logger.error("Error extracting property data",e)}})),e}extractPropertiesFromDocument(e){const t=[];return e.querySelectorAll("article.item[data-element-id]").forEach((e=>{try{const r=this.extractPropertyDataFromElement(e);r&&t.push(r)}catch(e){this.logger.error("Error extracting property data from element",e)}})),t}extractPropertyData(e){return this.extractPropertyDataFromElement(e)}extractPropertyDataFromElement(e){const t=e.getAttribute("data-element-id");if(!t)return null;const r=e.querySelector(".item-price"),n=r?.textContent?.replace(/[‚Ç¨\s]/g,"").replace(".","")||"0",i=parseInt(n,10)||0,a=e.querySelector(".item-link"),o=a?.textContent?.trim()||"",s=a?.href||"",l=e.querySelectorAll(".item-detail");let c=null,d=null,g=null;l.forEach((e=>{const t=e.textContent?.trim()||"";if(t.includes("hab.")){const e=t.match(/(\d+)\s*hab\./);c=e?parseInt(e[1],10):null}else if(t.includes("m¬≤")){const e=t.match(/(\d+)\s*m¬≤/);d=e?parseInt(e[1],10):null}else(t.includes("Planta")||t.includes("Bajo"))&&(g=t)}));const m=!!e.querySelector(".item-parking"),h=e.querySelector(".item-description .ellipsis"),u=h?.textContent?.trim()||"",p=e.querySelectorAll(".listing-tags"),y=Array.from(p).map((e=>e.textContent?.trim()||"")),v=this.extractLocationFromTitle(o);return{id:t,title:o,price:i,rooms:c,size:d,floor:g,hasGarage:m,description:u,url:s,tags:y,location:v}}extractLocationFromTitle(e){const t=e.split(",");return t.length>=2?t[t.length-2].trim():""}}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}!function(){const e=r(273);"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{(new e.IdealistaInvestmentAnalyzer).initialize()})):(new e.IdealistaInvestmentAnalyzer).initialize()}()}();