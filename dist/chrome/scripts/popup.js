!function(){"use strict";var e={294:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigService=void 0;class n{static STORAGE_KEY="investmentAnalysisConfig";static DEFAULT_CONFIG={expenseConfig:{propertyManagementMonthly:150,insuranceMonthly:50,propertyTaxMonthly:100,communityFees:60,vacancyMaintenanceRate:.05,maintenanceContingencyRate:.01},mortgageConfig:{loanToValueRatio:.8,managementFeesRate:.1,interestRate:2.45},profitabilityThresholds:{excellent:6,good:4,fair:2},displayOptions:{showBadges:!0,showModal:!0,showLoadingStates:!0}};async getConfig(){try{const e=(await chrome.storage.sync.get(n.STORAGE_KEY))[n.STORAGE_KEY];if(!e)return n.DEFAULT_CONFIG;const t=this.migrateOldConfig(e);return{...n.DEFAULT_CONFIG,...t}}catch(e){return console.error("Error loading config:",e),n.DEFAULT_CONFIG}}migrateOldConfig(e){if(e.expenseConfig&&e.expenseConfig.communityFeesWithGarage&&!e.expenseConfig.communityFees){const t=Math.round(((e.expenseConfig.communityFeesWithGarage||80)+(e.expenseConfig.communityFeesWithoutGarage||40))/2);e.expenseConfig.communityFees=t,delete e.expenseConfig.communityFeesWithGarage,delete e.expenseConfig.communityFeesWithoutGarage}return e}async updateConfig(e){try{const t={...await this.getConfig(),...e};await chrome.storage.sync.set({[n.STORAGE_KEY]:t})}catch(e){throw console.error("Error saving config:",e),e}}async resetToDefaults(){try{await chrome.storage.sync.set({[n.STORAGE_KEY]:n.DEFAULT_CONFIG})}catch(e){throw console.error("Error resetting config:",e),e}}}t.ConfigService=n}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}!function(){const e=n(294);class t{configService;form;statusMessage;constructor(){this.configService=new e.ConfigService,this.form=document.getElementById("configForm"),this.statusMessage=document.getElementById("statusMessage"),this.initialize()}async initialize(){await this.loadConfig(),this.attachEventListeners()}async loadConfig(){try{const e=await this.configService.getConfig();this.populateForm(e)}catch(e){this.showStatus("Error al cargar la configuración","error")}}populateForm(e){const t={propertyManagement:document.getElementById("propertyManagement"),insurance:document.getElementById("insurance"),propertyTax:document.getElementById("propertyTax"),communityFees:document.getElementById("communityFees"),vacancyMaintenance:document.getElementById("vacancyMaintenance"),maintenanceContingency:document.getElementById("maintenanceContingency"),loanToValue:document.getElementById("loanToValue"),interestRate:document.getElementById("interestRate"),managementFees:document.getElementById("managementFees"),excellentThreshold:document.getElementById("excellentThreshold"),goodThreshold:document.getElementById("goodThreshold"),fairThreshold:document.getElementById("fairThreshold"),showBadges:document.getElementById("showBadges"),showModal:document.getElementById("showModal"),showLoadingStates:document.getElementById("showLoadingStates")};t.propertyManagement.value=e.expenseConfig.propertyManagementMonthly.toString(),t.insurance.value=e.expenseConfig.insuranceMonthly.toString(),t.propertyTax.value=e.expenseConfig.propertyTaxMonthly.toString(),t.communityFees.value=e.expenseConfig.communityFees.toString(),t.vacancyMaintenance.value=(100*e.expenseConfig.vacancyMaintenanceRate).toString(),t.maintenanceContingency.value=(100*e.expenseConfig.maintenanceContingencyRate).toString(),t.loanToValue.value=(100*e.mortgageConfig.loanToValueRatio).toString(),t.interestRate.value=e.mortgageConfig.interestRate.toString(),t.managementFees.value=(100*e.mortgageConfig.managementFeesRate).toString(),t.excellentThreshold.value=e.profitabilityThresholds.excellent.toString(),t.goodThreshold.value=e.profitabilityThresholds.good.toString(),t.fairThreshold.value=e.profitabilityThresholds.fair.toString(),t.showBadges.checked=e.displayOptions.showBadges,t.showModal.checked=e.displayOptions.showModal,t.showLoadingStates.checked=e.displayOptions.showLoadingStates}attachEventListeners(){this.form.addEventListener("submit",this.handleSubmit.bind(this));const e=document.getElementById("resetButton");e?.addEventListener("click",this.handleReset.bind(this))}async handleSubmit(e){e.preventDefault();try{new FormData(this.form);const e=this.extractConfigFromForm();await this.configService.updateConfig(e),this.showStatus("Configuración guardada correctamente","success"),setTimeout((()=>{this.hideStatus()}),3e3)}catch(e){this.showStatus("Error al guardar la configuración","error")}}async handleReset(){try{await this.configService.resetToDefaults(),await this.loadConfig(),this.showStatus("Configuración restaurada a valores por defecto","success"),setTimeout((()=>{this.hideStatus()}),3e3)}catch(e){this.showStatus("Error al restaurar la configuración","error")}}extractConfigFromForm(){const e=e=>{const t=document.getElementById(e);return t?.value||""},t=e=>{const t=document.getElementById(e);return t?.checked||!1};return{expenseConfig:{propertyManagementMonthly:parseInt(e("propertyManagement")),insuranceMonthly:parseInt(e("insurance")),propertyTaxMonthly:parseInt(e("propertyTax")),communityFees:parseInt(e("communityFees")),vacancyMaintenanceRate:parseFloat(e("vacancyMaintenance"))/100,maintenanceContingencyRate:parseFloat(e("maintenanceContingency"))/100},mortgageConfig:{loanToValueRatio:parseFloat(e("loanToValue"))/100,interestRate:parseFloat(e("interestRate")),managementFeesRate:parseFloat(e("managementFees"))/100},profitabilityThresholds:{excellent:parseFloat(e("excellentThreshold")),good:parseFloat(e("goodThreshold")),fair:parseFloat(e("fairThreshold"))},displayOptions:{showBadges:t("showBadges"),showModal:t("showModal"),showLoadingStates:t("showLoadingStates")}}}showStatus(e,t){this.statusMessage.textContent=e,this.statusMessage.className=`status-message status-${t}`,this.statusMessage.style.display="block"}hideStatus(){this.statusMessage.style.display="none"}}document.addEventListener("DOMContentLoaded",(()=>{new t}))}()}();